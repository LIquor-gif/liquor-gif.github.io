mixin postInfo(item)
  .post-info
    .post-date
      h6.ui.header
        i.calendar.icon
        .content
          != full_date(item.date, 'll')

mixin postTags(item)
  if item.tags && item.tags.length
    .post-tags
      each tag in item.tags.toArray()
        - var colorArr = ['red','orange','yellow','olive','green','teal','blue','violet','purple','pink','brown','grey','black'];
        - var index = Math.floor(Math.random()*colorArr.length);
          a(class="ui #{colorArr[index]} label" href= url_for(tag.path))
            != tag.name

//- Index Page
mixin posts()
  .post-list
    - page.posts.each(function (item) {
    article.post-list-item
      figure.post-thumbnail
        if item.bgimage
          a
            img(src=item.bgimage)
      header.post-header
        .post-meta
          span.post-date
            != full_date(item.date, 'll')
          span.post-tag
            a(href= url_for(item.tags.toArray()[0].path))
              != item.tags.toArray()[0].name
        h3.post-title
          a(href= url_for(item.path))
            != item.title
      .post-content
        != item.excerpt
    - })

//- Archive Page
mixin postList()
  .archive
    .ui.animated.list
      - var year = 0;
      - var change = false;
      - page.posts.each(function (item) {
          - var itemYear = date(item.date, 'YYYY') - 0;
          - change = year !== itemYear;
          - year = change ? itemYear : year;
          if change 
            h2.archive-year!=year
          .post-item.item
            +postInfo(item)
            a.post-title-link(href= url_for(item.path))
              != item.title
      - })

mixin archiveList()
  ul.archive-list
    - var month = 0, year = 0;
    - var years = {};
    - var change = false;
    - site.posts.each(function (item) {
        - var itemMonth = date(item.date, 'MM') - 0;
        - change = month !== itemMonth;
        - month = change ? itemMonth : month;
        if change
          - year = date(item.date, 'YYYY') - 0;
          - years[year] = years[year]? years[year] : {};
          - years[year][month] = 1;
        else
          - year = date(item.date, 'YYYY') - 0;
          - years[year][month]++;
    - })
    - for(y in years) {
      - for(m in years[y]) {
        li.archive-list-item
          - var timeLabel = y + '年' + m + '月'; 
          a.archive-list-link(href='/archives/#{y}/0#{m}')!=timeLabel
            span (#{years[y][m]})
      - } 
    - }

//- Tags Page
mixin tagList()
  .tag
    != tagcloud({min_font: 14, max_font: 14, amount: 100, orderby: 'count', color: false})

//- Post Page
mixin post(item)
  .post
    article.post-block
      h1.post-title
        != item.title
      +postInfo(item)
      .post-content
        != item.content